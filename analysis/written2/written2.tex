\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage{caption}
\usepackage{adjustbox}
\usetikzlibrary{arrows}

\begin{document}

\section{Maximum degree of $3\Delta_{avg} + 8$}

Maciek: Intro to the algorithm, comparison with DISC algorithm.
(high degree nodes participate as helpers, H-H edges are replaced, low degree nodes are $n/4$ of all nodes)

\subsection{Algorithm}


The algorithm arbitrarily assigns a node to \emph{assist} each edge in the demand graph.
While doing so, it ensures that each node assists at most $\beta = \lceil\Delta_{avg}/2\rceil$ edges.


To construct the network, we first construct an \emph{assistant graph} $G'$ that is initially equal to the demand distribution graph $G_D$.
Then, we construct the network $N$ from $G'$.

Now we construct the assistant graph $G'$ based upon the assistant nodes assignment.
If the algorithm assigns $k \neq i,j$ to help the edge $(i, j)$, we replace the edge $(i, j)$ in $G'$ with 
2-hop paths through $k$:
$$ p(i,j) = 0$$
$$ p(i,k) = p(i,k) + p(i,j)$$
$$ p(k,j) = p(k,j) + p(i,j)$$
We say that the edges $(i,k)$ and $(k,j)$ added to (and from) intermediate nodes are \emph{intermediate edges}.
If the assisting node $k$ is chosen as either $i$ or $j$, then we leave the graph $G'$ unchanged.

Next, we construct the network $N$ based upon the assistant graph $G'$.
We start with an empty network $N$.
In $G'$, a node $i$ has two types of new neighbors: 
the set $G_i$ of intermediate nodes that replaced an initial edges of $i$, and the set $H_i$ of nodes in whose edges $i$ is assisting.
Among $G_i$ we distinguish the set $G_i^-$ (resp. $G_i^+$) of nodes that are connected with $i$ with an ingoing (resp. outgoing) edges.
For each node $i$, the algorithm constructs two Mehlhorn trees in $N$, one for $G_i^-$ and another for $G_i^+$, and connects its roots to $i$.
(reference to the Table + Figure of i,j and helper k)

Note that we skip the set $H_i$ while building the Mehlhorn trees.
However, the connection (possibly indirect) between $i$ and a node $j \in H_i$ will appear while building the Mehlhorn tree of $j$.

\medskip

Now we claim that the algorithm has a sufficient number of nodes available as assistants
 (i.e., the total number of available assistants $n \cdot \beta$ is sufficient to help all $m$ edges).

  $$n \cdot \beta = \frac{n\Delta_{avg}}{2} = m$$

and we conclude that the algorithm is well-defined.

\medskip

Now, we upper-bound the maximal final degree of the nodes.
%The degree of each node may increase beyond its initial degree because it helps other nodes, and, more importantly, because it may participate in Mehlhorn trees of its neighbors.
A node $i$ is not involved in the Mehlhorn trees of the intermediate nodes
that replaced a node between $i$ and another node.
Furthermore, these new connections with intermediate nodes are contained in 2 Mehlhorn trees
whose root is $i$. Additionally $i$ is involved in one Mehlhorn tree
for each node it helped, in total at most $2\beta$ trees.

Let $\gamma_i$ be the final degree of the node $i$.
A participation in each Mehlhorn tree adds at most $3$ edges to a node, thus

$$\gamma_i \leq 2 + 6\beta \leq 2 + 6 \times \left(\frac{\Delta_{avg}}{2}+1\right) = 8 + 3\Delta_{avg},$$

Thus, the algorithm produces a network
with maximum degree of $3\Delta_{avg} + 8$.

Remarks.
When a node is assigned to help one of its incident edges, it is the most efficient.
However, the analysis holds for arbitrary assignments.

\subsection{Examples}

\begin{figure}[!htb]\centering
\begin{minipage}[b]{.3\linewidth}
  \begin{adjustbox}{width=\linewidth}
      \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
          thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

        \node[main node] (1) {1};
        \node[main node] (2) [below left of=1] {2};
        \node[main node] (3) [below right of=2] {3};
        \node[main node] (4) [below right of=1] {4};

        \path[every node/.style={font=\sffamily\small}]
        (2) edge[dashed] node [above,rotate=45] {0.7} (1)
        (4) edge node [below] {0.3} (2);
      \end{tikzpicture}
  \end{adjustbox}
  \captionsetup{labelformat=empty}
  \caption{Demand graph $G_D$}
\end{minipage}
\hspace{0.2 cm}
\begin{minipage}[b]{.3\linewidth}
  \begin{adjustbox}{width=\linewidth}
    \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
      thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

    \node[main node] (1) {1};
    \node[main node] (2) [below left of=1] {2};
    \node[main node] (3) [below right of=2] {3};
    \node[main node] (4) [below right of=1] {4};

    \path[every node/.style={font=\sffamily\small}]
    (1) edge node [above,rotate=45] {0.3} (2)
    (2) edge[dashed] node [below,rotate=-45] {0.7} (3)
    (3) edge[dashed] node [right] {0.7} (1)
    (4) edge node [above,rotate=-45] {0.3} (1);
    \end{tikzpicture}
  \end{adjustbox}
  \captionsetup{labelformat=empty}
  \caption{Intermediate graph $G'$}
\end{minipage}
\hspace{0.2 cm}
\begin{minipage}[b]{.3\linewidth}
  \begin{adjustbox}{width=\linewidth}
    \begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto,node distance=3cm,
      thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

    \node[main node] (1) {1};
    \node[main node] (2) [below left of=1] {2};
    \node[main node] (3) [below right of=2] {3};
    \node[main node] (4) [below right of=1] {4};

    \path[every node/.style={font=\sffamily\small}]
    (2) edge node [right] {} (3)
    (3) edge node [above] {} (1)
    (4) edge node [left] {} (1);
    \end{tikzpicture}
  \end{adjustbox}
  \captionsetup{labelformat=empty}
  \caption{Bounded network $N$}
\end{minipage}
\end{figure}
\end{document}
